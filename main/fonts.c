#include "fonts.h"
#include "lcd_driver.h"
#include "esp_log.h"
#include <string.h>

static const char *TAG = "FONTS";

// 全局LCD对象指针
static lcd_display_t *g_lcd = NULL;

// 设置全局LCD对象
void set_global_lcd(lcd_display_t *lcd)
{
    g_lcd = lcd;
    ESP_LOGI(TAG, "Global LCD pointer set successfully");
}

// 完整的57个汉字字模数据
const uint8_t hz_zhou_bitmap[] = {
    0x00,0x00,0x3F,0xF8,0x21,0x08,0x21,0x08,0x2F,0xE8,0x21,0x08,0x21,0x08,0x3F,0xF8,
    0x20,0x08,0x27,0xC8,0x24,0x48,0x24,0x48,0x27,0xC8,0x40,0x08,0x40,0x28,0x80,0x10
};

const uint8_t hz_mon_bitmap[] = {
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFE,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
};

const uint8_t hz_tue_bitmap[] = {
    0x00,0x00,0x00,0x00,0x00,0x00,0x3F,0xF8,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFE,0x00,0x00,0x00,0x00,0x00,0x00
};

const uint8_t hz_wed_bitmap[] = {
    0x00,0x00,0x00,0x00,0x7F,0xFC,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3F,0xF8,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFE,0x00,0x00,0x00,0x00
};

const uint8_t hz_thu_bitmap[] = {
    0x00,0x00,0x00,0x00,0x7F,0xFC,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,
    0x48,0x44,0x48,0x3C,0x50,0x04,0x60,0x04,0x40,0x04,0x7F,0xFC,0x40,0x04,0x00,0x00
};

const uint8_t hz_fri_bitmap[] = {
    0x00,0x00,0x7F,0xFC,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0x3F,0xF0,0x04,0x10,
    0x04,0x10,0x04,0x10,0x04,0x10,0x08,0x10,0x08,0x10,0x08,0x10,0xFF,0xFE,0x00,0x00
};

const uint8_t hz_sat_bitmap[] = {
    0x02,0x00,0x01,0x00,0x00,0x80,0x00,0x80,0x00,0x00,0xFF,0xFE,0x00,0x00,0x00,0x00,
    0x04,0x40,0x04,0x20,0x08,0x10,0x08,0x08,0x10,0x08,0x20,0x04,0x40,0x04,0x00,0x00
};

const uint8_t hz_sunday_bitmap[] = {
    0x00,0x00,0x1F,0xF0,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x1F,0xF0,
    0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x1F,0xF0,0x10,0x10
};

const uint8_t hz_rain_bitmap[] = {
    0x00,0x00,0xFF,0xFE,0x01,0x00,0x01,0x00,0x01,0x00,0x7F,0xFC,0x41,0x04,0x41,0x04,
    0x49,0x44,0x45,0x24,0x41,0x04,0x49,0x44,0x45,0x24,0x41,0x04,0x41,0x14,0x40,0x08
};

const uint8_t hz_snow_bitmap[] = {
    0x3F,0xF8,0x01,0x00,0x7F,0xFE,0x41,0x02,0x9D,0x74,0x01,0x00,0x1D,0x70,0x00,0x00,
    0x3F,0xF8,0x00,0x08,0x00,0x08,0x1F,0xF8,0x00,0x08,0x00,0x08,0x3F,0xF8,0x00,0x08
};

const uint8_t hz_sun_bitmap[] = {
    0x00,0x20,0x00,0x20,0x7B,0xFE,0x48,0x20,0x49,0xFC,0x48,0x20,0x4B,0xFE,0x78,0x00,
    0x49,0xFC,0x49,0x04,0x49,0xFC,0x49,0x04,0x79,0xFC,0x49,0x04,0x01,0x14,0x01,0x08
};

const uint8_t hz_cloudy_bitmap[] = {
    0x00,0x00,0x7D,0xFC,0x45,0x04,0x49,0x04,0x49,0x04,0x51,0xFC,0x49,0x04,0x49,0x04,
    0x45,0x04,0x45,0xFC,0x45,0x04,0x69,0x04,0x52,0x04,0x42,0x04,0x44,0x14,0x48,0x08
};

const uint8_t hz_duo_bitmap[] = {
    0x02,0x00,0x02,0x00,0x07,0xF0,0x08,0x20,0x38,0x40,0x04,0x80,0x03,0x40,0x0C,0x80,
    0x71,0xF8,0x02,0x08,0x0C,0x10,0x32,0x20,0x01,0x40,0x01,0x80,0x0E,0x00,0x70,0x00
};

const uint8_t hz_yun_bitmap[] = {
    0x00,0x00,0x3F,0xF8,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFE,0x02,0x00,
    0x04,0x00,0x04,0x00,0x08,0x40,0x10,0x20,0x20,0x10,0x7F,0xF8,0x20,0x08,0x00,0x08
};

const uint8_t hz_xu_bitmap[] = {
    0x00,0x80,0x20,0x80,0x10,0x80,0x11,0xFC,0x01,0x20,0x02,0x20,0xF0,0x20,0x10,0x20,
    0x13,0xFE,0x10,0x20,0x10,0x20,0x10,0x20,0x14,0x20,0x18,0x20,0x10,0x20,0x00,0x20
};

const uint8_t hz_chang_bitmap[] = {
    0x1F,0xF0,0x10,0x10,0x10,0x10,0x1F,0xF0,0x10,0x10,0x10,0x10,0x1F,0xF0,0x00,0x00,
    0x3F,0xF8,0x20,0x08,0x20,0x08,0x3F,0xF8,0x20,0x08,0x20,0x08,0x3F,0xF8,0x20,0x08
};

const uint8_t hz_dong_bitmap[] = {
    0x02,0x00,0x02,0x00,0x02,0x00,0x7F,0xFC,0x04,0x00,0x09,0x00,0x11,0x00,0x21,0x00,
    0x3F,0xF8,0x01,0x00,0x09,0x20,0x11,0x10,0x21,0x08,0x41,0x04,0x05,0x00,0x02,0x00
};

const uint8_t hz_xi1_bitmap[] = {
    0x00,0x00,0xFF,0xFE,0x04,0x40,0x04,0x40,0x04,0x40,0x3F,0xF8,0x24,0x48,0x24,0x48,
    0x24,0x48,0x24,0x48,0x28,0x38,0x30,0x08,0x20,0x08,0x20,0x08,0x3F,0xF8,0x20,0x08
};

const uint8_t hz_nan_bitmap[] = {
    0x01,0x00,0x01,0x00,0xFF,0xFE,0x01,0x00,0x01,0x00,0x7F,0xFC,0x48,0x24,0x44,0x44,
    0x4F,0xE4,0x41,0x04,0x41,0x04,0x5F,0xF4,0x41,0x04,0x41,0x04,0x41,0x14,0x40,0x08
};

const uint8_t hz_bei_bitmap[] = {
    0x04,0x40,0x04,0x40,0x04,0x40,0x04,0x44,0x04,0x48,0x7C,0x50,0x04,0x60,0x04,0x40,
    0x04,0x40,0x04,0x40,0x04,0x40,0x04,0x42,0x1C,0x42,0xE4,0x42,0x44,0x3E,0x04,0x00
};

const uint8_t hz_feng_bitmap[] = {
    0x00,0x00,0x3F,0xF0,0x20,0x10,0x20,0x10,0x28,0x50,0x24,0x50,0x22,0x90,0x22,0x90,
    0x21,0x10,0x21,0x10,0x22,0x90,0x22,0x92,0x24,0x4A,0x48,0x4A,0x40,0x06,0x80,0x02
};

const uint8_t hz_guan_bitmap[] = {
    0x10,0x10,0x08,0x10,0x08,0x20,0x00,0x00,0x3F,0xF8,0x01,0x00,0x01,0x00,0x01,0x00,
    0xFF,0xFE,0x01,0x00,0x02,0x80,0x02,0x80,0x04,0x40,0x08,0x20,0x30,0x18,0xC0,0x06
};

const uint8_t hz_zhu_bitmap[] = {
    0x00,0x80,0x20,0x40,0x10,0x00,0x17,0xFC,0x80,0x40,0x40,0x40,0x40,0x40,0x10,0x40,
    0x13,0xFC,0x20,0x40,0xE0,0x40,0x20,0x40,0x20,0x40,0x20,0x40,0x2F,0xFE,0x00,0x00
};

const uint8_t hz_fen_bitmap[] = {
    0x10,0x10,0x10,0x50,0x94,0x50,0x54,0x50,0x58,0x88,0x10,0x88,0xFD,0x04,0x32,0xFA,
    0x38,0x48,0x54,0x48,0x54,0x48,0x90,0x48,0x10,0x88,0x10,0x88,0x11,0x28,0x12,0x10
};

const uint8_t hz_si_bitmap[] = {
    0x08,0x10,0x08,0x10,0x10,0x20,0x10,0x20,0x22,0x44,0x42,0x84,0x7C,0xF8,0x04,0x08,
    0x08,0x10,0x10,0x20,0x20,0x40,0x7E,0xFC,0x00,0x00,0x00,0x00,0xFF,0xFE,0x00,0x00
};

const uint8_t hz_shu_bitmap[] = {
    0x08,0x20,0x49,0x20,0x2A,0x20,0x08,0x3E,0xFF,0x44,0x2A,0x44,0x49,0x44,0x88,0xA4,
    0x10,0x28,0xFE,0x28,0x22,0x10,0x42,0x10,0x64,0x28,0x18,0x28,0x34,0x44,0xC2,0x82
};

const uint8_t hz_hang_bitmap[] = {
    0x10,0x80,0x10,0x40,0x10,0x40,0x13,0xFC,0xFC,0x00,0x10,0x00,0x31,0xF0,0x39,0x10,
    0x55,0x10,0x55,0x10,0x91,0x10,0x11,0x12,0x11,0x12,0x12,0x12,0x12,0x0E,0x14,0x00
};

const uint8_t hz_zhou2_bitmap[] = {
    0x10,0x04,0x10,0x84,0x10,0x84,0x10,0x84,0x10,0x84,0x54,0xA4,0x52,0x94,0x52,0x94,
    0x90,0x84,0x10,0x84,0x10,0x84,0x10,0x84,0x20,0x84,0x20,0x84,0x40,0x04,0x80,0x04
};

const uint8_t hz_nian_bitmap[] = {
    0x10,0x00,0x10,0x00,0x1F,0xFC,0x20,0x80,0x20,0x80,0x40,0x80,0x1F,0xF8,0x10,0x80,
    0x10,0x80,0x10,0x80,0xFF,0xFE,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80
};

const uint8_t hz_yue_bitmap[] = {
    0x00,0x00,0x1F,0xF8,0x10,0x08,0x10,0x08,0x10,0x08,0x1F,0xF8,0x10,0x08,0x10,0x08,
    0x10,0x08,0x1F,0xF8,0x10,0x08,0x10,0x08,0x20,0x08,0x20,0x08,0x40,0x28,0x80,0x10
};

const uint8_t hz_ri_bitmap[] = {
    0x00,0x00,0x1F,0xF0,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x1F,0xF0,
    0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x1F,0xF0,0x10,0x10
};

const uint8_t hz_di_bitmap[] = {
    0x10,0x20,0x10,0x20,0x10,0x20,0x11,0x20,0x11,0x2C,0xFD,0x34,0x11,0x64,0x13,0xA4,
    0x11,0x24,0x11,0x34,0x11,0x28,0x1D,0x22,0xE1,0x22,0x41,0x02,0x00,0xFE,0x00,0x00
};

const uint8_t hz_dian_bitmap[] = {
    0x02,0x00,0x02,0x00,0x02,0x00,0x03,0xFC,0x02,0x00,0x02,0x00,0x3F,0xF0,0x20,0x10,
    0x20,0x10,0x20,0x10,0x3F,0xF0,0x00,0x00,0x24,0x88,0x22,0x44,0x42,0x44,0x80,0x04
};

const uint8_t hz_tian_bitmap[] = {
    0x00,0x00,0x3F,0xF8,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0xFF,0xFE,0x01,0x00,
    0x02,0x80,0x02,0x80,0x04,0x40,0x04,0x40,0x08,0x20,0x10,0x10,0x20,0x08,0xC0,0x06
};

const uint8_t hz_qi_bitmap[] = {
    0x10,0x00,0x10,0x00,0x3F,0xFC,0x20,0x00,0x4F,0xF0,0x80,0x00,0x3F,0xF0,0x00,0x10,
    0x00,0x10,0x00,0x10,0x00,0x10,0x00,0x10,0x00,0x0A,0x00,0x0A,0x00,0x06,0x00,0x02
};

const uint8_t hz_wen_bitmap[] = {
    0x00,0x00,0x23,0xF8,0x12,0x08,0x12,0x08,0x83,0xF8,0x42,0x08,0x42,0x08,0x13,0xF8,
    0x10,0x00,0x27,0xFC,0xE4,0xA4,0x24,0xA4,0x24,0xA4,0x24,0xA4,0x2F,0xFE,0x00,0x00
};

const uint8_t hz_du_bitmap[] = {
    0x01,0x00,0x00,0x80,0x3F,0xFE,0x22,0x20,0x22,0x20,0x3F,0xFC,0x22,0x20,0x22,0x20,
    0x23,0xE0,0x20,0x00,0x2F,0xF0,0x24,0x10,0x42,0x20,0x41,0xC0,0x86,0x30,0x38,0x0E
};

const uint8_t hz_wei_bitmap[] = {
    0x01,0x00,0x01,0x00,0x01,0x00,0x3F,0xF8,0x01,0x00,0x01,0x00,0x01,0x00,0xFF,0xFE,
    0x03,0x80,0x05,0x40,0x09,0x20,0x11,0x10,0x21,0x08,0xC1,0x06,0x01,0x00,0x01,0x00
};

const uint8_t hz_zhi_bitmap[] = {
    0x20,0x00,0x20,0x00,0x20,0x7C,0x7E,0x44,0x48,0x44,0x88,0x44,0x08,0x44,0x08,0x44,
    0xFF,0x44,0x08,0x44,0x14,0x44,0x14,0x44,0x22,0x7C,0x22,0x44,0x42,0x00,0x80,0x00
};

const uint8_t hz_lian_bitmap[] = {
    0x00,0x40,0x20,0x40,0x17,0xFE,0x10,0x80,0x00,0xA0,0x01,0x20,0xF3,0xFC,0x10,0x20,
    0x10,0x20,0x10,0x20,0x17,0xFE,0x10,0x20,0x10,0x20,0x28,0x20,0x47,0xFE,0x00,0x00
};

const uint8_t hz_jie_bitmap[] = {
    0x10,0x80,0x10,0x40,0x13,0xFC,0x10,0x00,0xFD,0x08,0x10,0x90,0x17,0xFE,0x10,0x40,
    0x18,0x40,0x37,0xFE,0xD0,0x88,0x11,0x08,0x10,0x90,0x10,0x60,0x51,0x98,0x26,0x04
};

const uint8_t hz_zhong_bitmap[] = {
    0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x3F,0xF8,0x21,0x08,0x21,0x08,0x21,0x08,
    0x21,0x08,0x21,0x08,0x3F,0xF8,0x21,0x08,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00
};

const uint8_t hz_yi_bitmap[] = {
    0x00,0x00,0x3F,0xF0,0x00,0x10,0x00,0x10,0x00,0x10,0x20,0x10,0x20,0x10,0x3F,0xF0,
    0x20,0x00,0x20,0x00,0x20,0x00,0x20,0x04,0x20,0x04,0x20,0x04,0x1F,0xFC,0x00,0x00
};

const uint8_t hz_neng_bitmap[] = {
    0x10,0x40,0x24,0x44,0x42,0x48,0xFF,0x70,0x01,0x40,0x00,0x42,0x7E,0x42,0x42,0x3E,
    0x42,0x00,0x7E,0x44,0x42,0x48,0x42,0x70,0x7E,0x40,0x42,0x42,0x4A,0x42,0x44,0x3E
};

const uint8_t hz_huo_bitmap[] = {
    0x08,0x20,0x08,0x20,0xFF,0xFE,0x08,0x20,0x44,0x40,0x28,0x50,0x10,0x48,0x28,0x40,
    0x4F,0xFE,0x98,0x40,0x28,0xA0,0x48,0xA0,0x89,0x10,0x09,0x10,0x52,0x08,0x24,0x06
};

const uint8_t hz_qu_bitmap[] = {
    0x00,0x00,0xFF,0x80,0x22,0xFC,0x22,0x44,0x3E,0x44,0x22,0x44,0x22,0x44,0x3E,0x44,
    0x22,0x28,0x22,0x28,0x27,0xA8,0xFA,0x10,0x42,0x10,0x02,0x28,0x02,0x44,0x02,0x82
};

const uint8_t hz_xin_bitmap[] = {
    0x08,0x40,0x08,0x20,0x0B,0xFE,0x10,0x00,0x10,0x00,0x31,0xFC,0x30,0x00,0x50,0x00,
    0x91,0xFC,0x10,0x00,0x10,0x00,0x11,0xFC,0x11,0x04,0x11,0x04,0x11,0xFC,0x11,0x04
};

const uint8_t hz_xi2_bitmap[] = {
    0x01,0x00,0x02,0x00,0x1F,0xF0,0x10,0x10,0x1F,0xF0,0x10,0x10,0x1F,0xF0,0x10,0x10,
    0x1F,0xF0,0x10,0x10,0x01,0x00,0x08,0x84,0x48,0x92,0x48,0x12,0x87,0xF0,0x00,0x00
};

const uint8_t hz_xiao_bitmap[] = {
    0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x11,0x10,0x11,0x08,0x11,0x04,
    0x21,0x04,0x21,0x02,0x41,0x02,0x81,0x02,0x01,0x00,0x01,0x00,0x05,0x00,0x02,0x00
};

const uint8_t hz_da_bitmap[] = {
    0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0xFF,0xFE,0x01,0x00,0x01,0x00,
    0x02,0x80,0x02,0x80,0x04,0x40,0x04,0x40,0x08,0x20,0x10,0x10,0x20,0x08,0xC0,0x06
};

const uint8_t hz_bao_bitmap[] = {
    0x1F,0xF0,0x10,0x10,0x1F,0xF0,0x10,0x10,0x1F,0xF0,0x08,0x20,0x7F,0xFC,0x08,0x20,
    0xFF,0xFE,0x08,0x20,0x31,0x18,0xC9,0x26,0x05,0x40,0x09,0x20,0x15,0x10,0x22,0x08
};

const uint8_t hz_lei_bitmap[] = {
    0x00,0x00,0x3F,0xF8,0x01,0x00,0x7F,0xFE,0x41,0x02,0x9D,0x74,0x01,0x00,0x1D,0x70,
    0x00,0x00,0x3F,0xF8,0x21,0x08,0x21,0x08,0x3F,0xF8,0x21,0x08,0x21,0x08,0x3F,0xF8
};

const uint8_t hz_bing_bitmap[] = {
    0x00,0x40,0x40,0x40,0x20,0x40,0x20,0x44,0x00,0x68,0x07,0x70,0x11,0x60,0x11,0x50,
    0x21,0x50,0xE2,0x48,0x22,0x48,0x24,0x44,0x28,0x42,0x20,0x40,0x21,0x40,0x00,0x80
};

const uint8_t hz_bao2_bitmap[] = {
    0x3F,0xF8,0x01,0x00,0x7F,0xFE,0x41,0x02,0x9D,0x74,0x01,0x00,0x1D,0x70,0x08,0x00,
    0x1F,0xF0,0x20,0x10,0x5F,0x90,0x10,0x90,0x1F,0xD0,0x10,0x20,0x10,0x04,0x0F,0xFC
};

const uint8_t hz_wu_bitmap[] = {
    0x3F,0xF8,0x01,0x00,0x7F,0xFE,0x41,0x02,0x9D,0x74,0x01,0x00,0x1D,0x70,0x04,0x00,
    0x0F,0xE0,0x14,0x40,0x03,0x80,0x1C,0x70,0xE2,0x0E,0x0F,0xE0,0x04,0x20,0x18,0x60
};

const uint8_t hz_mai_bitmap[] = {
    0x3F,0xF8,0x01,0x00,0x7F,0xFE,0x41,0x02,0x9D,0x74,0x30,0x00,0xCB,0xFC,0x2D,0x24,
    0x31,0xFC,0xC9,0x24,0x15,0xFC,0x64,0x20,0x0D,0xFC,0x34,0x20,0xC5,0xFE,0x18,0x00
};

const uint8_t hz_feng2_bitmap[] = {
    0x00,0x00,0x3F,0xF0,0x20,0x10,0x20,0x10,0x28,0x50,0x24,0x50,0x22,0x90,0x22,0x90,
    0x21,0x10,0x21,0x10,0x22,0x90,0x22,0x92,0x24,0x4A,0x48,0x4A,0x40,0x06,0x80,0x02
};

const uint8_t hz_re_bitmap[] = {
    0x10,0x40,0x10,0x40,0x10,0x40,0xFD,0xF8,0x10,0x48,0x10,0x48,0x1C,0xC8,0x30,0x48,
    0xD0,0xAA,0x10,0xAA,0x51,0x06,0x22,0x02,0x00,0x00,0x48,0x88,0x44,0x44,0x84,0x44
};

// 完整的57个汉字字模数组
const chinese_char_t chinese_chars[] = {
    {"周", hz_zhou_bitmap, 16},
    {"一", hz_mon_bitmap, 16},
    {"二", hz_tue_bitmap, 16},
    {"三", hz_wed_bitmap, 16},
    {"四", hz_thu_bitmap, 16},
    {"五", hz_fri_bitmap, 16},
    {"六", hz_sat_bitmap, 16},
    {"日", hz_sunday_bitmap, 16},
    {"晴", hz_sun_bitmap, 16},
    {"阴", hz_cloudy_bitmap, 16},
    {"雨", hz_rain_bitmap, 16},
    {"雪", hz_snow_bitmap, 16},
    {"多", hz_duo_bitmap, 16},
    {"云", hz_yun_bitmap, 16},
    {"许", hz_xu_bitmap, 16},
    {"昌", hz_chang_bitmap, 16},
    {"东", hz_dong_bitmap, 16},
    {"西", hz_xi1_bitmap, 16},
    {"南", hz_nan_bitmap, 16},
    {"北", hz_bei_bitmap, 16},
    {"风", hz_feng_bitmap, 16},
    {"关", hz_guan_bitmap, 16},
    {"注", hz_zhu_bitmap, 16},
    {"粉", hz_fen_bitmap, 16},
    {"丝", hz_si_bitmap, 16},
    {"数", hz_shu_bitmap, 16},
    {"杭", hz_hang_bitmap, 16},
    {"州", hz_zhou2_bitmap, 16},
    {"年", hz_nian_bitmap, 16},
    {"月", hz_yue_bitmap, 16},
    {"地", hz_di_bitmap, 16},
    {"点", hz_dian_bitmap, 16},
    {"天", hz_tian_bitmap, 16},
    {"气", hz_qi_bitmap, 16},
    {"温", hz_wen_bitmap, 16},
    {"度", hz_du_bitmap, 16},
    {"未", hz_wei_bitmap, 16},
    {"知", hz_zhi_bitmap, 16},
    {"连", hz_lian_bitmap, 16},
    {"接", hz_jie_bitmap, 16},
    {"中", hz_zhong_bitmap, 16},
    {"已", hz_yi_bitmap, 16},
    {"能", hz_neng_bitmap, 16},
    {"获", hz_huo_bitmap, 16},
    {"取", hz_qu_bitmap, 16},
    {"信", hz_xin_bitmap, 16},
    {"息", hz_xi2_bitmap, 16},
    {"小", hz_xiao_bitmap, 16},
    {"大", hz_da_bitmap, 16},
    {"暴", hz_bao_bitmap, 16},
    {"雷", hz_lei_bitmap, 16},
    {"冰", hz_bing_bitmap, 16},
    {"雹", hz_bao2_bitmap, 16},
    {"雾", hz_wu_bitmap, 16},
    {"霾", hz_mai_bitmap, 16},
    {"热", hz_re_bitmap, 16},
    {"", NULL, 0} // 结束标记
};

// 在指定位置绘制矩形
void lcd_draw_rect(lcd_display_t *lcd, uint16_t x, uint16_t y, uint16_t w, uint16_t h, uint16_t color)
{
    if (lcd == NULL) return;
    
    // 绘制上边框
    for (int i = 0; i < w; i++) {
        lcd_draw_pixel(lcd, x + i, y, color);
        lcd_draw_pixel(lcd, x + i, y + h - 1, color);
    }
    
    // 绘制左右边框
    for (int i = 0; i < h; i++) {
        lcd_draw_pixel(lcd, x, y + i, color);
        lcd_draw_pixel(lcd, x + w - 1, y + i, color);
    }
}

// 绘制单个汉字
void show_single_char(int x, int y, const char* ch, uint16_t color)
{
    if (g_lcd == NULL) {
        ESP_LOGE(TAG, "LCD not initialized");
        return;
    }
    
    if (ch == NULL || strlen(ch) < 3) {
        ESP_LOGE(TAG, "Invalid Chinese character");
        return;
    }
    
    // 查找对应的汉字字模
    for (int i = 0; chinese_chars[i].bitmap != NULL; i++) {
        if (chinese_chars[i].index[0] == ch[0] && 
            chinese_chars[i].index[1] == ch[1] && 
            chinese_chars[i].index[2] == ch[2]) {
            
            const uint8_t *bitmap = chinese_chars[i].bitmap;
            int width = chinese_chars[i].width;
            
            ESP_LOGD(TAG, "Drawing char at (%d,%d), width=%d", x, y, width);
            
            // 绘制16x16点阵
            for (int row = 0; row < 16; row++) {
                uint8_t byte1 = bitmap[row * 2];     // 每行前8位
                uint8_t byte2 = bitmap[row * 2 + 1]; // 每行后8位
                
                // 处理前8位
                for (int col = 0; col < 8; col++) {
                    if (byte1 & (0x80 >> col)) { // 从高位到低位
                        lcd_draw_pixel(g_lcd, x + col, y + row, color);
                    }
                }
                
                // 处理后8位
                for (int col = 0; col < 8; col++) {
                    if (byte2 & (0x80 >> col)) {
                        lcd_draw_pixel(g_lcd, x + col + 8, y + row, color);
                    }
                }
            }
            return;
        }
    }
    
    // 如果找不到汉字，绘制一个占位矩形
    ESP_LOGW(TAG, "Character not found: %c%c%c", ch[0], ch[1], ch[2]);
    lcd_draw_rect(g_lcd, x, y, 16, 16, color);
}

// 绘制汉字字符串
void show_custom_font(int x, int y, const char* str, uint16_t color)
{
    if (g_lcd == NULL) {
        ESP_LOGE(TAG, "LCD not initialized");
        return;
    }
    
    if (str == NULL || strlen(str) == 0) {
        return;
    }
    
    int current_x = x;
    int len = strlen(str);
    
    ESP_LOGD(TAG, "Drawing string: %s, length: %d", str, len);
    
    for (int i = 0; i < len; i += 3) {
        if (i + 2 < len) {
            // 提取一个汉字（3字节）
            char ch[4] = {str[i], str[i+1], str[i+2], '\0'};
            
            // 检查是否会超出屏幕边界
            if (current_x + 16 <= g_lcd->width && y + 16 <= g_lcd->height) {
                show_single_char(current_x, y, ch, color);
            } else {
                ESP_LOGW(TAG, "Character out of screen bounds: x=%d, y=%d", current_x, y);
            }
            
            current_x += 16; // 每个汉字占16像素宽度
            
            // 如果超出屏幕宽度，停止绘制
            if (current_x >= g_lcd->width - 16) {
                break;
            }
        }
    }
}

